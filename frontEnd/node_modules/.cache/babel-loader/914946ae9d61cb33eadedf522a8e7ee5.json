{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { RPCErrorCode, SDKErrorCode, SDKWarningCode } from '@magic-sdk/types';\nimport { isJsonRpcErrorCode } from '../util/type-guards';\nimport { SDKEnvironment, envNameToNpmName } from './sdk-environment'; // --- Error/warning classes\n\n/**\n * This error type represents internal SDK errors. This could be developer\n * mistakes (or Magic's mistakes), or execution errors unrelated to standard\n * JavaScript exceptions.\n */\n\nvar MagicSDKError =\n/** @class */\nfunction (_super) {\n  __extends(MagicSDKError, _super);\n\n  function MagicSDKError(code, rawMessage) {\n    var _this = _super.call(this, \"Magic SDK Error: [\" + code + \"] \" + rawMessage) || this;\n\n    _this.code = code;\n    _this.rawMessage = rawMessage;\n    _this.__proto__ = Error;\n    Object.setPrototypeOf(_this, MagicSDKError.prototype);\n    return _this;\n  }\n\n  return MagicSDKError;\n}(Error);\n\nexport { MagicSDKError };\n/**\n * This error type communicates exceptions that occur during execution in the\n * Magic `<iframe>` context.\n */\n\nvar MagicRPCError =\n/** @class */\nfunction (_super) {\n  __extends(MagicRPCError, _super);\n\n  function MagicRPCError(sourceError) {\n    var _this = _super.call(this) || this;\n\n    _this.__proto__ = Error;\n    var codeNormalized = Number(sourceError === null || sourceError === void 0 ? void 0 : sourceError.code);\n    _this.rawMessage = (sourceError === null || sourceError === void 0 ? void 0 : sourceError.message) || 'Internal error';\n    _this.code = isJsonRpcErrorCode(codeNormalized) ? codeNormalized : RPCErrorCode.InternalError;\n    _this.message = \"Magic RPC Error: [\" + _this.code + \"] \" + _this.rawMessage;\n    Object.setPrototypeOf(_this, MagicRPCError.prototype);\n    return _this;\n  }\n\n  return MagicRPCError;\n}(Error);\n\nexport { MagicRPCError };\n/**\n * In contrast to `SDKError` objects, this \"warning\" type communicates important\n * context that does not rise to the level of an exception. These should be\n * logged rather than thrown.\n */\n\nvar MagicSDKWarning =\n/** @class */\nfunction () {\n  function MagicSDKWarning(code, rawMessage) {\n    this.code = code;\n    this.rawMessage = rawMessage;\n    this.message = \"Magic SDK Warning: [\" + code + \"] \" + rawMessage;\n  }\n  /**\n   * Logs this warning to the console.\n   */\n\n\n  MagicSDKWarning.prototype.log = function () {\n    console.warn(this.message);\n  };\n\n  return MagicSDKWarning;\n}();\n\nexport { MagicSDKWarning };\n/**\n * This error type is reserved for communicating errors that arise during\n * execution of Magic SDK Extension methods. Compare this to the `SDKError`\n * type, specifically in context of Extensions.\n */\n\nvar MagicExtensionError =\n/** @class */\nfunction (_super) {\n  __extends(MagicExtensionError, _super);\n\n  function MagicExtensionError(ext, code, rawMessage, data) {\n    var _this = _super.call(this, \"Magic Extension Error (\" + ext.name + \"): [\" + code + \"] \" + rawMessage) || this;\n\n    _this.code = code;\n    _this.rawMessage = rawMessage;\n    _this.data = data;\n    _this.__proto__ = Error;\n    Object.setPrototypeOf(_this, MagicExtensionError.prototype);\n    return _this;\n  }\n\n  return MagicExtensionError;\n}(Error);\n\nexport { MagicExtensionError };\n/**\n * In contrast to `MagicExtensionError` objects, this \"warning\" type\n * communicates important context that does not rise to the level of an\n * exception. These should be logged rather than thrown.\n */\n\nvar MagicExtensionWarning =\n/** @class */\nfunction () {\n  function MagicExtensionWarning(ext, code, rawMessage) {\n    this.code = code;\n    this.rawMessage = rawMessage;\n    this.message = \"Magic Extension Warning (\" + ext.name + \"): [\" + code + \"] \" + rawMessage;\n  }\n  /**\n   * Logs this warning to the console.\n   */\n\n\n  MagicExtensionWarning.prototype.log = function () {\n    console.warn(this.message);\n  };\n\n  return MagicExtensionWarning;\n}();\n\nexport { MagicExtensionWarning }; // --- SDK error factories\n\nexport function createMissingApiKeyError() {\n  return new MagicSDKError(SDKErrorCode.MissingApiKey, 'Please provide an API key that you acquired from the Magic developer dashboard.');\n}\nexport function createModalNotReadyError() {\n  return new MagicSDKError(SDKErrorCode.ModalNotReady, 'Modal is not ready.');\n}\nexport function createMalformedResponseError() {\n  return new MagicSDKError(SDKErrorCode.MalformedResponse, 'Response from the Magic iframe is malformed.');\n}\nexport function createExtensionNotInitializedError(member) {\n  return new MagicSDKError(SDKErrorCode.ExtensionNotInitialized, \"Extensions must be initialized with a Magic SDK instance before `Extension.\" + member + \"` can be accessed. Do not invoke `Extension.\" + member + \"` inside an extension constructor.\");\n}\nexport function createWebAuthnNotSupportError() {\n  return new MagicSDKError(SDKErrorCode.WebAuthnNotSupported, 'WebAuthn is not supported in this device.');\n}\nexport function createWebAuthCreateCredentialError(message) {\n  return new MagicSDKError(SDKErrorCode.WebAuthnCreateCredentialError, \"Error creating credential: \" + message);\n}\nexport function createIncompatibleExtensionsError(extensions) {\n  var npmName = envNameToNpmName[SDKEnvironment.sdkName];\n  var msg = \"Some extensions are incompatible with `\" + npmName + \"@\" + SDKEnvironment.version + \"`:\";\n  extensions.filter(function (ext) {\n    return typeof ext.compat !== 'undefined' && ext.compat !== null;\n  }).forEach(function (ext) {\n    var compat = ext.compat[npmName];\n    /* istanbul ignore else */\n\n    if (typeof compat === 'string') {\n      msg += \"\\n  - Extension `\" + ext.name + \"` supports version(s) `\" + compat + \"`\";\n    } else if (!compat) {\n      msg += \"\\n  - Extension `\" + ext.name + \"` does not support \" + SDKEnvironment.target + \" environments.\";\n    } // Else case is irrelevant here here\n    // (we filter out extensions with missing `compat` field)\n\n  });\n  return new MagicSDKError(SDKErrorCode.IncompatibleExtensions, msg);\n}\nexport function createInvalidArgumentError(options) {\n  /**\n   * Parses the argument index (given by `argument`) to attach the correct ordinal suffix.\n   * (i.e.: 1st, 2nd, 3rd, 4th, etc.)\n   */\n  var ordinalSuffix = function (i) {\n    var iAdjusted = i + 1; // Argument is zero-indexed.\n\n    var j = iAdjusted % 10;\n    var k = iAdjusted % 100;\n    if (j === 1 && k !== 11) return iAdjusted + \"st\";\n    if (j === 2 && k !== 12) return iAdjusted + \"nd\";\n    if (j === 3 && k !== 13) return iAdjusted + \"rd\";\n    return iAdjusted + \"th\";\n  };\n\n  return new MagicSDKError(SDKErrorCode.InvalidArgument, \"Invalid \" + ordinalSuffix(options.argument) + \" argument given to `\" + options.procedure + \"`.\\n\" + (\"  Expected: `\" + options.expected + \"`\\n\") + (\"  Received: `\" + options.received + \"`\"));\n} // --- SDK warning factories\n\nexport function createDuplicateIframeWarning() {\n  return new MagicSDKWarning(SDKWarningCode.DuplicateIframe, 'Duplicate iframes found.');\n}\nexport function createSynchronousWeb3MethodWarning() {\n  return new MagicSDKWarning(SDKWarningCode.SyncWeb3Method, 'Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.');\n}\nexport function createReactNativeEndpointConfigurationWarning() {\n  return new MagicSDKWarning(SDKWarningCode.ReactNativeEndpointConfiguration, \"CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The `endpoint` parameter SHOULD NOT be provided. The Magic `<iframe>` is automatically wrapped by a WebView pointed at `\" + SDKEnvironment.defaultEndpoint + \"`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.\");\n}\nexport function createDeprecationWarning(options) {\n  var method = options.method,\n      removalVersions = options.removalVersions,\n      useInstead = options.useInstead;\n  var npmName = envNameToNpmName[SDKEnvironment.sdkName];\n  var removalVersion = removalVersions[npmName];\n  var useInsteadSuffix = useInstead ? \" Use `\" + useInstead + \"` instead.\" : '';\n  var message = \"`\" + method + \"` will be removed from `\" + npmName + \"` in version `\" + removalVersion + \"`.\" + useInsteadSuffix;\n  return new MagicSDKWarning(SDKWarningCode.DeprecationNotice, message);\n}","map":{"version":3,"mappings":"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","names":["RPCErrorCode","SDKErrorCode","SDKWarningCode","isJsonRpcErrorCode","SDKEnvironment","envNameToNpmName","__extends","code","rawMessage","_super","_this","Error","Object","setPrototypeOf","MagicSDKError","prototype","sourceError","codeNormalized","Number","message","InternalError","MagicRPCError","MagicSDKWarning","console","warn","ext","data","name","MagicExtensionError","MagicExtensionWarning","createMissingApiKeyError","MissingApiKey","createModalNotReadyError","ModalNotReady","createMalformedResponseError","MalformedResponse","createExtensionNotInitializedError","member","ExtensionNotInitialized","createWebAuthnNotSupportError","WebAuthnNotSupported","createWebAuthCreateCredentialError","WebAuthnCreateCredentialError","createIncompatibleExtensionsError","extensions","npmName","sdkName","msg","version","filter","compat","forEach","target","IncompatibleExtensions","createInvalidArgumentError","options","ordinalSuffix","i","iAdjusted","j","k","InvalidArgument","argument","procedure","expected","received","createDuplicateIframeWarning","DuplicateIframe","createSynchronousWeb3MethodWarning","SyncWeb3Method","createReactNativeEndpointConfigurationWarning","ReactNativeEndpointConfiguration","defaultEndpoint","createDeprecationWarning","removalVersions","useInstead","removalVersion","useInsteadSuffix","method","DeprecationNotice"],"sourceRoot":"","sources":["../../../src/core/sdk-exceptions.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}