{"ast":null,"code":"var _jsxFileName = \"/home/crow/Scrivania/AF2/newFrontEnd/src/Pages/Announce/UploadSTL.js\";\nimport React, { Component } from 'react';\nimport { create } from 'ipfs-http-client';\nimport './UploadSTL.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar file = null;\nvar photo = null;\n\nclass UploadSTL extends Component {\n  constructor(_ref) {\n    let {\n      changeFile\n    } = _ref;\n    super();\n    this.state = {\n      file: undefined,\n      photo: undefined,\n      Taur: undefined,\n      Taup: undefined,\n      Component: undefined\n    };\n    this.changeFile = changeFile;\n    this.ipfs = create('https://ipfs.infura.io:5001');\n  }\n\n  onChange(event) {\n    if (event.target.files[0] === undefined) return;\n    let reader = new FileReader();\n    reader.readAsArrayBuffer(event.target.files[0]);\n\n    reader.onload = () => {\n      this.setState({\n        file: reader.result\n      });\n      console.log(event.target.files[0]);\n    };\n\n    let reader2 = new FileReader();\n    reader2.readAsDataURL(event.target.files[0]);\n\n    reader2.onload = () => {\n      this.changeFile(reader2.result);\n    };\n  }\n\n  getFrame() {\n    if (!this.state.file) {\n      alert('Carica un STL prima di fare una foto!');\n      return;\n    }\n\n    let canvas = document.getElementsByTagName('canvas')[0];\n    this.setState({\n      photo: canvas.toDataURL()\n    });\n  }\n\n  async submitForm(event) {\n    if (!this.state.file || !this.state.photo) {\n      alert('Carica un STL e fai una foto prima di Annunciare!');\n      return;\n    }\n\n    file = await this.ipfs.add(this.state.file);\n    photo = await this.ipfs.add(this.state.photo);\n\n    if (file && file.path && photo && photo.path) {\n      alert('Operazione completata!');\n      console.log('DEBUG: Hash File -> ' + file.path);\n      console.log('DEBUG: Hash Foto -> ' + photo.path);\n      console.log('DEBUG: Component ' + this.state.Component + ' Taur ' + this.state.Taur + ' Taup ' + this.state.Taup);\n    }\n  }\n\n  async downloadDesign(event) {\n    if (file == null) {\n      alert('Devi prima caricare il tuo file!');\n      return;\n    }\n\n    var nomefile = 'prova.stl';\n    var link = document.createElement('a');\n    link.download = 'test';\n    link.href = 'https://ipfs.infura.io/ipfs/' + file.path + '?filename=' + nomefile;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  async returnHash(event) {\n    if (file == null) {\n      alert('Devi prima caricare il tuo file!');\n      return;\n    } else return file.path;\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"announceButton\",\n        type: \"file\",\n        onChange: event => this.onChange(event)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"announceButton\",\n        type: \"number\",\n        placeholder: \"Component\",\n        onChange: event => this.setState({\n          Component: event.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"announceButton\",\n        type: \"number\",\n        placeholder: \"Taur\",\n        onChange: event => this.setState({\n          Taur: event.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"announceButton\",\n        type: \"number\",\n        placeholder: \"Taup\",\n        onChange: event => this.setState({\n          Taup: event.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        class: \"announceButton\",\n        onClick: event => this.getFrame(event),\n        children: \"Take a snap!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        class: \"announceButton\",\n        onClick: event => this.submitForm(event),\n        children: \"Announce Design\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        class: \"announceButton\",\n        onClick: event => this.downloadDesign(event),\n        children: \"Download your Design\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default UploadSTL;","map":{"version":3,"names":["React","Component","create","file","photo","UploadSTL","constructor","changeFile","state","undefined","Taur","Taup","ipfs","onChange","event","target","files","reader","FileReader","readAsArrayBuffer","onload","setState","result","console","log","reader2","readAsDataURL","getFrame","alert","canvas","document","getElementsByTagName","toDataURL","submitForm","add","path","downloadDesign","nomefile","link","createElement","download","href","body","appendChild","click","removeChild","returnHash","render","value"],"sources":["/home/crow/Scrivania/AF2/newFrontEnd/src/Pages/Announce/UploadSTL.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport { create } from 'ipfs-http-client';\r\nimport './UploadSTL.css';\r\nvar file = null;\r\nvar photo = null;\r\n\r\nclass UploadSTL extends Component {\r\n\r\n  constructor({changeFile}) {\r\n    super();\r\n    this.state = {file: undefined, photo: undefined, Taur: undefined, Taup: undefined, Component: undefined};\r\n    this.changeFile = changeFile;\r\n    this.ipfs = create('https://ipfs.infura.io:5001');\r\n  } \r\n  \r\n\tonChange(event) {\r\n    if(event.target.files[0] === undefined) return;\r\n    let reader = new FileReader();\r\n    reader.readAsArrayBuffer(event.target.files[0]);\r\n    reader.onload = () => {\r\n      this.setState({file : reader.result}); console.log(event.target.files[0])\r\n    }\r\n    let reader2 = new FileReader();\r\n    reader2.readAsDataURL(event.target.files[0]);\r\n    reader2.onload = () => {\r\n      this.changeFile(reader2.result);\r\n    }\r\n  }\r\n\r\n  getFrame() {\r\n    if(!this.state.file) {\r\n      alert('Carica un STL prima di fare una foto!');\r\n      return;\r\n    }\r\n    let canvas = document.getElementsByTagName('canvas')[0];\r\n    this.setState({photo: canvas.toDataURL()});\r\n  }\r\n\r\n  async submitForm(event) {\r\n    if(!this.state.file || !this.state.photo) {\r\n      alert('Carica un STL e fai una foto prima di Annunciare!');\r\n      return;\r\n    }\r\n    file = await this.ipfs.add(this.state.file);\r\n    photo = await this.ipfs.add(this.state.photo);\r\n    if(file && file.path && photo && photo.path) {\r\n      alert('Operazione completata!');\r\n      console.log('DEBUG: Hash File -> ' + file.path);\r\n      console.log('DEBUG: Hash Foto -> ' + photo.path);\r\n      console.log('DEBUG: Component ' + this.state.Component + ' Taur ' + this.state.Taur + ' Taup ' + this.state.Taup);\r\n    }\r\n  }\r\n\r\n  async downloadDesign(event) {\r\n    if(file == null) {\r\n      alert('Devi prima caricare il tuo file!');\r\n      return;\r\n    }\r\n    var nomefile = 'prova.stl';\r\n    var link = document.createElement('a');\r\n    link.download = 'test';\r\n    link.href = 'https://ipfs.infura.io/ipfs/' + file.path + '?filename=' + nomefile;\r\n\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n\r\n  async returnHash(event) {\r\n    if(file == null) {\r\n      alert('Devi prima caricare il tuo file!');\r\n      return;\r\n    }\r\n    else return file.path;\r\n  }\r\n\r\n\trender() {\r\n\t\treturn(\r\n      <>\r\n        {/*<img class=\"screenshotDiv\" src={this.state.photo}/>*/}\r\n        {/*<div class=\"announceDiv\">*/}\r\n          <input class=\"announceButton\" type=\"file\" onChange={(event) => this.onChange(event)}/>\r\n          <input class=\"announceButton\" type=\"number\" placeholder=\"Component\" onChange={(event) => this.setState({Component: event.target.value})}/>\r\n          <input class=\"announceButton\" type=\"number\" placeholder=\"Taur\" onChange={(event) => this.setState({Taur: event.target.value})}/>\r\n          <input class=\"announceButton\" type=\"number\" placeholder=\"Taup\" onChange={(event) => this.setState({Taup: event.target.value})}/>\r\n          <button class=\"announceButton\" onClick={(event) => this.getFrame(event)}>Take a snap!</button>\r\n          <button class=\"announceButton\" onClick={(event) => this.submitForm(event)}>Announce Design</button>\r\n          <button class=\"announceButton\" onClick={(event) => this.downloadDesign(event)}>Download your Design</button>\r\n        {/*</div>*/}\r\n      </>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default UploadSTL;"],"mappings":"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"},"metadata":{},"sourceType":"module"}