{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nimport { PayloadTransport } from '@magic-sdk/provider';\n\nvar WebTransport =\n/** @class */\nfunction (_super) {\n  __extends(WebTransport, _super);\n\n  function WebTransport() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Initialize the underlying `Window.onmessage` event listener.\n   */\n\n\n  WebTransport.prototype.init = function () {\n    var _this = this;\n\n    window.addEventListener('message', function (event) {\n      var e_1, _a;\n\n      var _b;\n\n      if (event.origin === _this.endpoint) {\n        if (event.data && event.data.msgType && _this.messageHandlers.size) {\n          // If the response object is undefined, we ensure it's at least an\n          // empty object before passing to the event listener.\n\n          /* eslint-disable-next-line no-param-reassign */\n          event.data.response = (_b = event.data.response) !== null && _b !== void 0 ? _b : {};\n\n          try {\n            for (var _c = __values(_this.messageHandlers.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\n              var handler = _d.value;\n              handler(event);\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  return WebTransport;\n}(PayloadTransport);\n\nexport { WebTransport };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,gBAAT,QAAiC,qBAAjC;;AAEA;AAAA;AAAA;AAAkCC;;AAAlC;;AAmBC;AAlBC;;;;;AAGUC,gCAAV;AAAA;;AACEC,UAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,UAACC,KAAD,EAAoB;;;;;AACrD,UAAIA,KAAK,CAACC,MAAN,KAAiBC,KAAI,CAACC,QAA1B,EAAoC;AAClC,YAAIH,KAAK,CAACI,IAAN,IAAcJ,KAAK,CAACI,IAAN,CAAWC,OAAzB,IAAoCH,KAAI,CAACI,eAAL,CAAqBC,IAA7D,EAAmE;AACjE;AACA;;AACA;AACAP,eAAK,CAACI,IAAN,CAAWI,QAAX,GAAmB,MAAGR,KAAK,CAACI,IAAN,CAAWI,QAAd,MAAsB,IAAtB,IAAsBC,aAAtB,GAAsBA,EAAtB,GAA0B,EAA7C;;;AACA,iBAAsB,uBAAI,CAACH,eAAL,CAAqBI,MAArB,KAA6BC,cAAnD,EAAmD,QAAnD,EAAmDA,cAAnD,EAAqD;AAAhD,kBAAMC,OAAO,WAAb;AACHA,qBAAO,CAACZ,KAAD,CAAP;AACD;;;;;;;;;;;;AACF;AACF;AACF,KAZD;AAaD,GAdS;;AAeZ;AAAC,CAnBD,CAAkCL,gBAAlC","names":["PayloadTransport","__extends","WebTransport","window","addEventListener","event","origin","_this","endpoint","data","msgType","messageHandlers","size","response","_b","values","_d","handler"],"sourceRoot":"","sources":["../../src/web-transport.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}