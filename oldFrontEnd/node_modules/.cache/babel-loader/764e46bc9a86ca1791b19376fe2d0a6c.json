{"ast":null,"code":"/* eslint-disable no-underscore-dangle, no-param-reassign */\nimport { isJsonRpcResponsePayload } from '../util/type-guards';\nimport { getPayloadId } from '../util/get-payload-id';\nvar payloadPreprocessedSymbol = Symbol('Payload pre-processed by Magic SDK');\n/**\n * To avoid \"pre-processing\" a payload more than once (and needlessly\n * incrementing our payload ID generator), we attach a symbol to detect a\n * payloads we've already visited.\n */\n\nfunction markPayloadAsPreprocessed(payload) {\n  Object.defineProperty(payload, payloadPreprocessedSymbol, {\n    value: true,\n    enumerable: false\n  });\n  return payload;\n}\n/**\n * Returns `true` if the payload has been visited by our \"pre-processing,\" in\n * `standardizeJsonRpcRequestPayload(...)`.\n */\n\n\nfunction isPayloadPreprocessed(payload) {\n  return !!payload[payloadPreprocessedSymbol];\n}\n/**\n * Returns a full `JsonRpcRequestPayload` from a potentially incomplete payload\n * object. This method mutates the given `payload` to preserve compatibility\n * with external libraries that perform their own `JsonRpcRequestPayload.id`\n * check to associate responses (such as `web3`).\n *\n * This function is no-op if the payload has already been processed before.\n */\n\n\nexport function standardizeJsonRpcRequestPayload(payload) {\n  var _a, _b, _c;\n\n  if (!isPayloadPreprocessed(payload)) {\n    payload.jsonrpc = (_a = payload.jsonrpc) !== null && _a !== void 0 ? _a : '2.0';\n    payload.id = getPayloadId();\n    payload.method = (_b = payload.method) !== null && _b !== void 0 ? _b : 'noop';\n    payload.params = (_c = payload.params) !== null && _c !== void 0 ? _c : [];\n    markPayloadAsPreprocessed(payload);\n  }\n\n  return payload;\n}\n/**\n * Build a valid JSON RPC payload for emitting to the Magic SDK iframe relayer.\n */\n\nexport function createJsonRpcRequestPayload(method, params) {\n  if (params === void 0) {\n    params = [];\n  }\n\n  return markPayloadAsPreprocessed({\n    params: params,\n    method: method,\n    jsonrpc: '2.0',\n    id: getPayloadId()\n  });\n}\n/**\n * Formats and standardizes a JSON RPC 2.0 response from a number of potential\n * sources.\n */\n\nvar JsonRpcResponse =\n/** @class */\nfunction () {\n  function JsonRpcResponse(responseOrPayload) {\n    if (responseOrPayload instanceof JsonRpcResponse) {\n      this._jsonrpc = responseOrPayload.payload.jsonrpc;\n      this._id = responseOrPayload.payload.id;\n      this._result = responseOrPayload.payload.result;\n      this._error = responseOrPayload.payload.error;\n    } else if (isJsonRpcResponsePayload(responseOrPayload)) {\n      this._jsonrpc = responseOrPayload.jsonrpc;\n      this._id = responseOrPayload.id;\n      this._result = responseOrPayload.result;\n      this._error = responseOrPayload.error;\n    } else {\n      this._jsonrpc = responseOrPayload.jsonrpc;\n      this._id = responseOrPayload.id;\n      this._result = undefined;\n      this._error = undefined;\n    }\n  }\n\n  JsonRpcResponse.prototype.applyError = function (error) {\n    this._error = error;\n    return this;\n  };\n\n  JsonRpcResponse.prototype.applyResult = function (result) {\n    this._result = result;\n    return this;\n  };\n\n  Object.defineProperty(JsonRpcResponse.prototype, \"hasError\", {\n    get: function () {\n      return typeof this._error !== 'undefined' && this._error !== null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(JsonRpcResponse.prototype, \"hasResult\", {\n    get: function () {\n      return typeof this._result !== 'undefined';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(JsonRpcResponse.prototype, \"payload\", {\n    get: function () {\n      return {\n        jsonrpc: this._jsonrpc,\n        id: this._id,\n        result: this._result,\n        error: this._error\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return JsonRpcResponse;\n}();\n\nexport { JsonRpcResponse };","map":{"version":3,"mappings":"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","names":["isJsonRpcResponsePayload","getPayloadId","payloadPreprocessedSymbol","Symbol","markPayloadAsPreprocessed","payload","Object","defineProperty","value","enumerable","isPayloadPreprocessed","standardizeJsonRpcRequestPayload","jsonrpc","_a","id","method","_b","params","_c","createJsonRpcRequestPayload","responseOrPayload","JsonRpcResponse","_jsonrpc","_id","_result","result","_error","error","undefined"],"sourceRoot":"","sources":["../../../src/core/json-rpc.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}