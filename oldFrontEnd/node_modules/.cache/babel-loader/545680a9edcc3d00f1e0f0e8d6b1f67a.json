{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { createJsonRpcRequestPayload, standardizeJsonRpcRequestPayload } from '../core/json-rpc';\nimport { BaseModule } from './base-module';\nimport { createExtensionNotInitializedError, MagicExtensionError, MagicExtensionWarning } from '../core/sdk-exceptions';\nimport { createPromiEvent, encodeJSON, decodeJSON, encodeQueryParameters, decodeQueryParameters, storage, isPromiEvent } from '../util';\n\nvar BaseExtension =\n/** @class */\nfunction (_super) {\n  __extends(BaseExtension, _super);\n\n  function BaseExtension() {\n    var _this = _super.call(this, undefined) || this;\n\n    _this.isInitialized = false;\n    _this.utils = {\n      createPromiEvent: createPromiEvent,\n      isPromiEvent: isPromiEvent,\n      encodeJSON: encodeJSON,\n      decodeJSON: decodeJSON,\n      encodeQueryParameters: encodeQueryParameters,\n      decodeQueryParameters: decodeQueryParameters,\n      createJsonRpcRequestPayload: createJsonRpcRequestPayload,\n      standardizeJsonRpcRequestPayload: standardizeJsonRpcRequestPayload,\n      storage: storage\n    };\n    var sdkAccessFields = ['request', 'transport', 'overlay', 'sdk']; // Disallow SDK access before initialization.\n\n    return new Proxy(_this, {\n      get: function (target, prop, receiver) {\n        if (sdkAccessFields.includes(prop) && !_this.isInitialized) {\n          throw createExtensionNotInitializedError(prop);\n        }\n\n        return Reflect.get(target, prop, receiver);\n      }\n    });\n  }\n  /**\n   * Registers a Magic SDK instance with this Extension.\n   */\n\n\n  BaseExtension.prototype.init = function (sdk) {\n    if (this.isInitialized) return;\n    this.sdk = sdk;\n    this.isInitialized = true;\n  };\n  /**\n   * Creates a deprecation warning wrapped with a native Magic SDK warning type.\n   * Best practice is to warn users of upcoming deprecations at least one major\n   * version before the change is implemented. You can use this method to\n   * communicate deprecations in a manner consistent with Magic SDK core code.\n   */\n\n\n  BaseExtension.prototype.createDeprecationWarning = function (options) {\n    var method = options.method,\n        removalVersion = options.removalVersion,\n        useInstead = options.useInstead;\n    var useInsteadSuffix = useInstead ? \" Use `\" + useInstead + \"` instead.\" : '';\n    var message = \"`\" + method + \"` will be removed from this Extension in version `\" + removalVersion + \"`.\" + useInsteadSuffix;\n    return new MagicExtensionWarning(this, 'DEPRECATION_NOTICE', message);\n  };\n  /**\n   * Creates a warning wrapped with a native Magic SDK warning type. This\n   * maintains consistency in warning messaging for consumers of Magic SDK and\n   * this Extension.\n   */\n\n\n  BaseExtension.prototype.createWarning = function (code, message) {\n    return new MagicExtensionWarning(this, code, message);\n  };\n  /**\n   * Creates an error wrapped with a native Magic SDK error type. This maintains\n   * consistency in error handling for consumers of Magic SDK and this\n   * Extension.\n   */\n\n\n  BaseExtension.prototype.createError = function (code, message, data) {\n    return new MagicExtensionError(this, code, message, data);\n  };\n  /**\n   * Throws an error wrapped with a native Magic SDK error type. This maintains\n   * consistency in error handling for consumers of Magic SDK and this\n   * Extension.\n   */\n\n\n  BaseExtension.prototype.raiseError = function (code, message, data) {\n    throw new MagicExtensionError(this, code, message, data);\n  };\n\n  return BaseExtension;\n}(BaseModule);\n\nvar InternalExtension =\n/** @class */\nfunction (_super) {\n  __extends(InternalExtension, _super);\n\n  function InternalExtension() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return InternalExtension;\n}(BaseExtension);\n\nvar Extension =\n/** @class */\nfunction (_super) {\n  __extends(Extension, _super);\n\n  function Extension() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * This is a special constructor used to mark an extension as \"official.\" Only\n   * official extensions can interact with the iframe using custom JSON RPC\n   * methods and business logic. This is intended for internal-use only and\n   * provides no advantage to open-source extension developers.\n   *\n   * @internal\n   */\n\n\n  Extension.Internal = InternalExtension;\n  return Extension;\n}(BaseExtension);\n\nexport { Extension };","map":{"version":3,"mappings":"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","names":["createJsonRpcRequestPayload","standardizeJsonRpcRequestPayload","BaseModule","createExtensionNotInitializedError","MagicExtensionError","MagicExtensionWarning","createPromiEvent","encodeJSON","decodeJSON","encodeQueryParameters","decodeQueryParameters","storage","isPromiEvent","__extends","_super","undefined","_this","sdkAccessFields","Proxy","get","target","prop","receiver","includes","isInitialized","Reflect","BaseExtension","sdk","options","removalVersion","useInstead","useInsteadSuffix","message","method","code","data","Extension","InternalExtension"],"sourceRoot":"","sources":["../../../src/modules/base-extension.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}