{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function bufferCount(bufferSize, startBufferEvery) {\n  if (startBufferEvery === void 0) {\n    startBufferEvery = null;\n  }\n\n  return function bufferCountOperatorFunction(source) {\n    return source.lift(new BufferCountOperator(bufferSize, startBufferEvery));\n  };\n}\n\nvar BufferCountOperator = /*@__PURE__*/function () {\n  function BufferCountOperator(bufferSize, startBufferEvery) {\n    this.bufferSize = bufferSize;\n    this.startBufferEvery = startBufferEvery;\n\n    if (!startBufferEvery || bufferSize === startBufferEvery) {\n      this.subscriberClass = BufferCountSubscriber;\n    } else {\n      this.subscriberClass = BufferSkipCountSubscriber;\n    }\n  }\n\n  BufferCountOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new this.subscriberClass(subscriber, this.bufferSize, this.startBufferEvery));\n  };\n\n  return BufferCountOperator;\n}();\n\nvar BufferCountSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(BufferCountSubscriber, _super);\n\n  function BufferCountSubscriber(destination, bufferSize) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.bufferSize = bufferSize;\n    _this.buffer = [];\n    return _this;\n  }\n\n  BufferCountSubscriber.prototype._next = function (value) {\n    var buffer = this.buffer;\n    buffer.push(value);\n\n    if (buffer.length == this.bufferSize) {\n      this.destination.next(buffer);\n      this.buffer = [];\n    }\n  };\n\n  BufferCountSubscriber.prototype._complete = function () {\n    var buffer = this.buffer;\n\n    if (buffer.length > 0) {\n      this.destination.next(buffer);\n    }\n\n    _super.prototype._complete.call(this);\n  };\n\n  return BufferCountSubscriber;\n}(Subscriber);\n\nvar BufferSkipCountSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(BufferSkipCountSubscriber, _super);\n\n  function BufferSkipCountSubscriber(destination, bufferSize, startBufferEvery) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.bufferSize = bufferSize;\n    _this.startBufferEvery = startBufferEvery;\n    _this.buffers = [];\n    _this.count = 0;\n    return _this;\n  }\n\n  BufferSkipCountSubscriber.prototype._next = function (value) {\n    var _a = this,\n        bufferSize = _a.bufferSize,\n        startBufferEvery = _a.startBufferEvery,\n        buffers = _a.buffers,\n        count = _a.count;\n\n    this.count++;\n\n    if (count % startBufferEvery === 0) {\n      buffers.push([]);\n    }\n\n    for (var i = buffers.length; i--;) {\n      var buffer = buffers[i];\n      buffer.push(value);\n\n      if (buffer.length === bufferSize) {\n        buffers.splice(i, 1);\n        this.destination.next(buffer);\n      }\n    }\n  };\n\n  BufferSkipCountSubscriber.prototype._complete = function () {\n    var _a = this,\n        buffers = _a.buffers,\n        destination = _a.destination;\n\n    while (buffers.length > 0) {\n      var buffer = buffers.shift();\n\n      if (buffer.length > 0) {\n        destination.next(buffer);\n      }\n    }\n\n    _super.prototype._complete.call(this);\n  };\n\n  return BufferSkipCountSubscriber;\n}(Subscriber);","map":{"version":3,"mappings":";AACA,OAAO,KAAEA,OAAT,MAAqB,OAArB;AA2DA,SAAMC,UAAN,QAA2B,eAA3B;OAAmD;AACjD,sBAAgB,WAAhB,EAAgB;AACdC,oBAAc,GAAK,IAAnB;AACD;;AACF;AAED;AAGE,GALD;;;uBAKiD,4BAAwB;WACjEC,oBAAoBC,YAAUF,kBAAK;SACtCE,aAAKA;SACNF;;SAAMA;AACL,WAAKG,eAAL,GAAuBC,qBAAvB;AACD,WACF;AAED;AACE;AACD;;AACHH,gCAACI,IAAD,GAAC;AAAA;AAOD,GAPA;;AAOuC;CAlBW;;yBAsB9C,gBAAM,UAAYC,MAAZ,EACP;SAFiD,kCAAkBA;;WAF5DF,sBAAiBG;;;AAIxBC;AAESA;AACR,WAAMA,KAAN;;;uBAIiB,WAASC,QAAU,UAAEC,KAAF,EAAE;QACpCC,MAAK;UACL,MAAKD;;QACNC;AACF;AAES;AACR;;;uBAEO,WAAiBC,YAAQ;QAC/BD;;AACD,wBAAM,CAAN,EAAM;AACP;AACH;;AAzBuCL,UAAU,CAyBhDO,SAzBsC,CAyBtCD,SAzBsC,CAyBtCP,IAzBsC,CAyBtC,IAzBsC;AAgCvC;;AAA2C;CA5BjC;;6BAiCN,gBAAM,UAAYC,MAAZ,EACP;SAFiD,sCAAkBA;;WAAUQ,uCAAwBZ;AAH9F,sBAAwB,CAACG,IAAzB,CAAyB,IAAzB,EAAyBE,WAAzB,KAAyB,IAAzB;;AACAC,uBAAkBN,UAAlB;;AAIPM;AAESA;AACF;;;2BAGM,WAAgBC,QAAQ;QAClCM;QAAQb,UAAS;QAAAF;QAAAgB;QAAAC;;SAClBA;;AAED,aAAS,GAACjB,gBAAV,KAAgC,CAAhC,EAAoC;AAClCgB,aAAM,KAAN,CAAe,EAAf;;;SAEA,IAAIE,WAAO,CAAMC,QAAKD;UACpBP,SAAQK,OAAQ;YAChB,MAAKN;;UACNC;AACFK;AACF;AAES;AACF;;;2BAGS,WAAeJ,YAAC;QAC7BG,KAAI;QAAOC,OAAM,GAAID,EAAE;QAAAR;;kBACrB,UAAgB,GAAC;UAClBI;;AACF;AACDJ,mBAAM,KAAN,CAAMI,MAAN;AACD;AAEH;;AAtC2CL,UAAU,CAsCpDO,SAtC0C,CAsC1CD,SAtC0C,CAsC1CP,IAtC0C,CAsC1C,IAtC0C;;;;CAKjC","names":["tslib_1","Subscriber","startBufferEvery","BufferCountOperator","bufferSize","subscriberClass","BufferCountSubscriber","call","_super","destination","_this","_next","value","buffer","_complete","prototype","BufferSkipCountSubscriber","_a","buffers","count","i","length"],"sources":["../../../src/internal/operators/bufferCount.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}